<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cat Quote Widget</title>
  <style>
    :root {
      --bg: #ffffff;
      --fg: #0f172a;
    }

    @media (prefers-color-scheme: dark) {
      :root {
        --bg: #0b1020;
        --fg: #e2e8f0;
      }
    }

    html, body {
      height: 100%;
      margin: 0;
      background: transparent;
      color: var(--fg);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
    }

    .widget {
      display: grid;
      place-items: center;
      height: 100%;
      padding: 12px;
      box-sizing: border-box;
    }

    .card {
      width: min(720px, 92vw);
      background: transparent;
      border-radius: 16px;
      padding: 18px 20px;
      position: relative;
      transition: transform 200ms ease;
    }

    .row {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .cat {
      font-size: 22px;
    }

    .quote {
      font-size: clamp(16px, 2.4vw, 22px);
      line-height: 1.35;
      font-weight: 600;
      letter-spacing: 0.2px;
    }

    .fade {
      opacity: 0;
      transform: translateY(6px);
      animation: fadeIn 520ms ease forwards;
    }

    @keyframes fadeIn {
      to { opacity: 1; transform: translateY(0); }
    }

    .controls {
      position: absolute;
      right: 8px;
      top: 8px;
      display: flex;
      gap: 4px;
    }

    .btn {
      appearance: none;
      background: transparent;
      color: var(--fg);
      font-size: 12px;
      border-radius: 10px;
      padding: 6px 8px;
      cursor: pointer;
      border: none;
    }

    .btn:hover { color: var(--fg); }
  </style>
</head>
<body>
  <div class="widget">
    <div class="card" tabindex="0" role="region" aria-label="Cat quote widget">
      <div class="controls" aria-hidden="false">
        <button class="btn" id="prevBtn" aria-label="Previous quote">â—€</button>
        <button class="btn" id="nextBtn" aria-label="Next quote">â–¶</button>
      </div>
      <div class="row">
        <div class="cat" id="catEmoji" aria-hidden="true">ðŸ˜º</div>
        <div class="quote" id="quote">Loadingâ€¦</div>
      </div>
    </div>
  </div>

  <script>
    const params = new URLSearchParams(location.search);
    const ROTATE_INTERVAL_MS = Math.max(1500, Number(params.get('interval')) || 6500);
    const RANDOMIZE = params.get('random') === '1' || false;

    const QUOTES = [
      "Purr-gress, not purr-fection.",
      "One task at a timeâ€¦ like batting toys under the couch.",
      "Stay paw-sitive, youâ€™re claw-ing through it!",
      "Check it off, then strut like a kitty.",
      "Tasks today, catnap later.",
      "Conquer the list, claim the sunny spot.",
      "Less hiss, more blissâ€”get it done.",
      "Whisker by whisker, youâ€™re making progress."
    ];

    const EMOJIS = ["ðŸ±","ðŸˆ","ðŸˆâ€â¬›","ðŸ¾","ðŸ˜¸"];

    const quoteEl = document.getElementById('quote');
    const catEl = document.getElementById('catEmoji');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');

    let order = QUOTES.map((q, i) => i);
    if (RANDOMIZE) {
      for (let i = order.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [order[i], order[j]] = [order[j], order[i]];
      }
    }

    let index = 0;
    let timer = null;
    let paused = false;

    function render(nextIndex) {
      index = (nextIndex + order.length) % order.length;
      const text = QUOTES[order[index]];
      const emoji = EMOJIS[Math.floor(Math.random() * EMOJIS.length)];
      quoteEl.classList.remove('fade');
      void quoteEl.offsetWidth;
      quoteEl.textContent = `â€œ${text}â€`;
      catEl.textContent = emoji;
      quoteEl.classList.add('fade');
    }

    function startTimer() {
      clearInterval(timer);
      timer = setInterval(() => { if (!paused) render(index + 1); }, ROTATE_INTERVAL_MS);
    }

    prevBtn.addEventListener('click', () => { render(index - 1); startTimer(); });
    nextBtn.addEventListener('click', () => { render(index + 1); startTimer(); });

    const card = document.querySelector('.card');
    card.addEventListener('mouseenter', () => { paused = true; });
    card.addEventListener('mouseleave', () => { paused = false; });
    card.addEventListener('focusin',  () => { paused = true; });
    card.addEventListener('focusout', () => { paused = false; });

    render(0);
    startTimer();
  </script>
</body>
</html>
